/*
 Copyright (c) 2011-2015, Pavel Shramov, Bruno Bergot - MIT licence
*/
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,e){if(c){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];f in b||(b[f]={});b=b[f]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,b,e){var c=this.length||0;0>b&&(b=Math.max(0,c+b));if(null==e||e>c)e=c;e=Number(e);0>e&&(e=Math.max(0,c+e));for(b=Number(b||0);b<e;b++)this[b]=a;return this}},"es6-impl","es3");
L.KML=L.FeatureGroup.extend({initialize:function(a){this._kml=a;this._layers={};a&&this.addKML(a)},addKML:function(a){var c=L.KML.parseKML(a);if(c&&c.length){for(var b=0;b<c.length;b++)this.fire("addlayer",{layer:c[b]}),this.addLayer(c[b]);this.latLngs=L.KML.getLatLngs(a);this.fire("loaded")}},latLngs:[]});
L.Util.extend(L.KML,{parseKML:function(a){var c=this.parseStyles(a);this.parseStyleMap(a,c);for(var b=a.getElementsByTagName("Folder"),e=[],f,d=0;d<b.length;d++)this._check_folder(b[d])&&(f=this.parseFolder(b[d],c))&&e.push(f);b=a.getElementsByTagName("Placemark");for(d=0;d<b.length;d++)this._check_folder(b[d])&&(f=this.parsePlacemark(b[d],a,c))&&e.push(f);b=a.getElementsByTagName("GroundOverlay");for(a=0;a<b.length;a++)(f=this.parseGroundOverlay(b[a]))&&e.push(f);return e},_check_folder:function(a,
c){for(a=a.parentNode;a&&"Folder"!==a.tagName;)a=a.parentNode;return!a||a===c},parseStyles:function(a){var c={};a=a.getElementsByTagName("Style");for(var b=0,e=a.length;b<e;b++){var f=this.parseStyle(a[b]);f&&(c["#"+f.id]=f)}return c},parseStyle:function(a){function c(a){for(var b={},d=0;d<a.childNodes.length;d++){var e=a.childNodes[d],g=e.tagName;if(h[g])if("hotSpot"===g)for(g=0;g<e.attributes.length;g++)b[e.attributes[g].name]=e.attributes[g].nodeValue;else{var k=e.childNodes[0].nodeValue;"color"===
g?(b.opacity=parseInt(k.substring(0,2),16)/255,b.color="#"+k.substring(6,8)+k.substring(4,6)+k.substring(2,4)):"width"===g?b.weight=k:"Icon"===g?(f=c(e),f.href&&(b.href=f.href)):"href"===g&&(b.href=k)}}return b}var b={},e={},f={},d,h={color:!0,width:!0,Icon:!0,href:!0,hotSpot:!0};(d=a.getElementsByTagName("LineStyle"))&&d[0]&&(b=c(d[0]));(d=a.getElementsByTagName("PolyStyle"))&&d[0]&&(e=c(d[0]));e.color&&(b.fillColor=e.color);e.opacity&&(b.fillOpacity=e.opacity);(d=a.getElementsByTagName("IconStyle"))&&
d[0]&&(f=c(d[0]));f.href&&(b.icon=new L.KMLIcon({iconUrl:f.href,shadowUrl:null,anchorRef:{x:f.x,y:f.y},anchorType:{x:f.xunits,y:f.yunits}}));(a=a.getAttribute("id"))&&b&&(b.id=a);return b},parseStyleMap:function(a,c){for(var b=a.getElementsByTagName("StyleMap"),e=0;e<b.length;e++){var f=b[e],d,h,k;(d=f.getElementsByTagName("key"))&&d[0]&&(h=d[0].textContent);(d=f.getElementsByTagName("styleUrl"))&&d[0]&&(k=d[0].textContent);"normal"===h&&(c["#"+f.getAttribute("id")]=c[k])}},parseFolder:function(a,
c){var b,e=[],f;b=a.getElementsByTagName("Folder");for(var d=0;d<b.length;d++)this._check_folder(b[d],a)&&(f=this.parseFolder(b[d],c))&&e.push(f);b=a.getElementsByTagName("Placemark");for(d=0;d<b.length;d++)this._check_folder(b[d],a)&&(f=this.parsePlacemark(b[d],a,c))&&e.push(f);b=a.getElementsByTagName("GroundOverlay");for(d=0;d<b.length;d++)this._check_folder(b[d],a)&&(f=this.parseGroundOverlay(b[d]))&&e.push(f);if(e.length)return 1===e.length?e[0]:new L.FeatureGroup(e)},parsePlacemark:function(a,
c,b,e){var f,d,h,k,l;e=e||{};l=a.getElementsByTagName("styleUrl");for(d=0;d<l.length;d++){var p=l[d].childNodes[0].nodeValue,m;for(m in b[p])e[m]=b[p][m]}if(a.getElementsByTagName("Style")[0]&&(d=this.parseStyle(a)))for(k in d)e[k]=d[k];k=["MultiGeometry","MultiTrack","gx:MultiTrack"];for(f in k)for(l=a.getElementsByTagName(k[f]),d=0;d<l.length;)return this.parsePlacemark(l[d],c,b,e);b=[];f=["LineString","Polygon","Point","Track","gx:Track"];for(h in f)for(k=f[h],l=a.getElementsByTagName(k),d=0;d<
l.length;d++)(m=this["parse"+k.replace(/gx:/,"")](l[d],c,e))&&b.push(m);if(b.length){var g=b[0];1<b.length&&(g=new L.FeatureGroup(b));var n,q="";l=a.getElementsByTagName("name");l.length&&l[0].childNodes.length&&(n=l[0].childNodes[0].nodeValue);l=a.getElementsByTagName("description");for(d=0;d<l.length;d++)for(h=0;h<l[d].childNodes.length;h++)q+=l[d].childNodes[h].nodeValue;if(n)g.on("add",function(){g.bindPopup("<h2>"+n+"</h2>"+q,{className:"kml-popup"})});return g}},parseCoords:function(a){a=a.getElementsByTagName("coordinates");
return this._read_coords(a[0])},parseLineString:function(a,c,b){a=this.parseCoords(a);if(a.length)return new L.Polyline(a,b)},parseTrack:function(a,c,b){a=c.getElementsByTagName("gx:coord");0===a.length&&(a=c.getElementsByTagName("coord"));c=[];for(var e=0;e<a.length;e++)c=c.concat(this._read_gxcoords(a[e]));if(c.length)return new L.Polyline(c,b)},parsePoint:function(a,c,b){a=a.getElementsByTagName("coordinates");if(a.length)return a=a[0].childNodes[0].nodeValue.split(","),new L.KMLMarker(new L.LatLng(a[1],
a[0]),b)},parsePolygon:function(a,c,b){var e=[],f=[],d,h;c=a.getElementsByTagName("outerBoundaryIs");for(d=0;d<c.length;d++)(h=this.parseCoords(c[d]))&&e.push(h);c=a.getElementsByTagName("innerBoundaryIs");for(d=0;d<c.length;d++)(h=this.parseCoords(c[d]))&&f.push(h);if(e.length)return b.fillColor&&(b.fill=!0),1===e.length?new L.Polygon(e.concat(f),b):new L.MultiPolygon(e,b)},getLatLngs:function(a){a=a.getElementsByTagName("coordinates");for(var c=[],b=0;b<a.length;b++)c=c.concat(this._read_coords(a[b]));
return c},_read_coords:function(a){var c="",b=[],e;for(e=0;e<a.childNodes.length;e++)c+=a.childNodes[e].nodeValue;c=c.split(/[\s\n]+/);for(e=0;e<c.length;e++)a=c[e].split(","),2>a.length||b.push(new L.LatLng(a[1],a[0]));return b},_read_gxcoords:function(a){var c=[];a=a.firstChild.nodeValue.split(" ");c.push(new L.LatLng(a[1],a[0]));return c},parseGroundOverlay:function(a){function c(a){for(var b={},d,e=0;e<a.childNodes.length;e++){d=a.childNodes[e];var h=d.tagName;if(f[h]){var g=d.childNodes[0].nodeValue;
"Icon"===h?(d=c(d),d.href&&(b.href=d.href)):"href"===h?b.href=g:"color"===h&&(b.opacity=parseInt(g.substring(0,2),16)/255,b.color="#"+g.substring(6,8)+g.substring(4,6)+g.substring(2,4))}}return b}var b=a.getElementsByTagName("LatLonBox")[0],e=new L.LatLngBounds([b.getElementsByTagName("south")[0].childNodes[0].nodeValue,b.getElementsByTagName("west")[0].childNodes[0].nodeValue],[b.getElementsByTagName("north")[0].childNodes[0].nodeValue,b.getElementsByTagName("east")[0].childNodes[0].nodeValue]),
f={Icon:!0,href:!0,color:!0},d={},d=c(a);void 0!==b.getElementsByTagName("rotation")[0]&&(a=b.getElementsByTagName("rotation")[0].childNodes[0].nodeValue,d.rotation=parseFloat(a));return new L.RotatedImageOverlay(d.href,e,{opacity:d.opacity,angle:d.rotation})}});
L.KMLIcon=L.Icon.extend({options:{iconSize:[32,32],iconAnchor:[16,16]},_setIconStyles:function(a,c){L.Icon.prototype._setIconStyles.apply(this,[a,c]);a.complete?this.applyCustomStyles(a):a.onload=this.applyCustomStyles.bind(this,a)},applyCustomStyles:function(a){var c=this.options;this.options.popupAnchor=[0,-.83*a.height];"fraction"===c.anchorType.x&&(a.style.marginLeft=-c.anchorRef.x*a.width+"px");"fraction"===c.anchorType.y&&(a.style.marginTop=-(1-c.anchorRef.y)*a.height+1+"px");"pixels"===c.anchorType.x&&
(a.style.marginLeft=-c.anchorRef.x+"px");"pixels"===c.anchorType.y&&(a.style.marginTop=c.anchorRef.y-a.height+1+"px")}});L.KMLMarker=L.Marker.extend({options:{icon:new L.KMLIcon.Default}});
L.RotatedImageOverlay=L.ImageOverlay.extend({options:{angle:0},_reset:function(){L.ImageOverlay.prototype._reset.call(this);this._rotate()},_animateZoom:function(a){L.ImageOverlay.prototype._animateZoom.call(this,a);this._rotate()},_rotate:function(){if(L.DomUtil.TRANSFORM)this._image.style[L.DomUtil.TRANSFORM]+=" rotate("+this.options.angle+"deg)";else if(L.Browser.ie){var a=Math.PI/180*this.options.angle,c=Math.cos(a),a=Math.sin(a);this._image.style.filter+=" progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11="+
c+", M12="+-a+", M21="+a+", M22="+c+")"}},getBounds:function(){return this._bounds}});
